(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48d44218"],{"1c72":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-calendar",{scopedSlots:e._u([{key:"dateCell",fn:function(t){t.date;var o=t.data;return[a("p",[e._v(" "+e._s(o.day.split("-").slice(1).join("-"))),a("br"),e._v(" "+e._s(e.dealMyDate(o.day))+" "+e._s(e.openDeail(o.isSelected,o))+" ")])]}}])}),a("el-dialog",{attrs:{title:e.displayDay,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-table",{attrs:{data:e.gridData}},[a("el-table-column",{attrs:{property:"dutyType",formatter:e.dutyTypeFormat,label:"值班级别",width:"90"}}),a("el-table-column",{attrs:{property:"stime",label:"开始时间",formatter:e.dateFormat,width:"100"}}),a("el-table-column",{attrs:{property:"etime",label:"结束时间",formatter:e.dateFormat,width:"100"}}),a("el-table-column",{attrs:{property:"etime",label:"值班时长",width:"70",formatter:e.diffTime}}),a("el-table-column",{attrs:{property:"name",label:"姓名",width:"70"}}),a("el-table-column",{attrs:{property:"tel",label:"联系电话",width:"120"}}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handDelete(t.row)}}},[e._v("删除")])]}}])})],1),a("br"),a("el-form",{attrs:{model:e.form}},[a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:24}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"值班时间"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}})],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:10}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"值班级别"}},[a("el-select",{attrs:{placeholder:"请选择值班级别"},model:{value:e.form.dutyType,callback:function(t){e.$set(e.form,"dutyType",t)},expression:"form.dutyType"}},[a("el-option",{attrs:{label:"值班领导",value:"1"}}),a("el-option",{attrs:{label:"值班组长",value:"2"}}),a("el-option",{attrs:{label:"值班员",value:"3"}})],1)],1)],1)],1),a("el-col",{attrs:{span:14}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"值班人员"}},[a("el-select",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择值班人员"},on:{change:e.handLeaderChanged},model:{value:e.form.personID,callback:function(t){e.$set(e.form,"personID",t)},expression:"form.personID"}},e._l(e.personList,(function(e){return a("el-option",{key:e.personID,attrs:{label:e.groupName+"/"+e.name+"("+e.post+")",value:e.personID}})})),1)],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:10}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1)],1)],1),a("el-col",{attrs:{span:10}},[a("el-button",{on:{click:e.handSave}},[e._v("增加值班人员")])],1)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("新增值班人员")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("关闭窗口")])],1)],1)],1)},r=[],s=(a("d81d"),a("b0c0"),a("96cf"),a("1da1")),i=a("7c15"),n=a("c466"),l=a("c1df"),c=a.n(l),u={data:function(){return{personList:[],pars:{pageSize:4,pageIndex:1,stime:void 0,etime:void 0},listPars:{pageSize:100,pageIndex:1,stime:void 0,etime:void 0},value:"",value1:[new Date,new Date],formLabelWidth:"80px",form:{schedulingID:void 0,dutyType:"",stime:"",etime:"",personID:void 0,schedulingDate:void 0,mobile:void 0},gridData:[],displayDay:"",dialogFormVisible:!1,resDate:[]}},methods:{openDeail:function(e,t){e&&(this.form.schedulingDate=t.day,this.dialogFormVisible=!0,this.displayDay=t.day+" 值班安排",this.loadDutyTime(),this.pars.stime=t.day,this.pars.etime=t.day,this.refreshList())},refreshList:function(){var e=this;this.gridData=[];var t=this.pageSchedulingList(this.pars);t.then((function(t){t.length>0&&(e.gridData=t[0].list)}))},loadThisMoth:function(){var e=this,t=c()().add("month",0).format("YYYY-MM")+"-01",a=c()(t).format("YYYY-MM-DD"),o=c()(t).add("month",1).add("days",-1).format("YYYY-MM-DD");this.listPars.stime=a,this.listPars.etime=o;var r=this.pageSchedulingList(this.listPars);r.then((function(t){console.log(t),t.map((function(t,a){var o={date:void 0,content:void 0};return o.date=t.schedulingDate,o.content="",e.resDate.push(o),t.list.map((function(e,t){return o.content+=e.name+",",void 0===e})),void 0===t}))})),console.log("resDate"),console.log(this.resDate)},dateFormat:function(e,t){console.log("row"),console.log(e);var a=e[t.property];return void 0==a?"":Object(n["a"])(a,"MM-dd hh:mm")},diffTime:function(e,t){var a=c()(e[t.property]),o=c()(e["stime"]),r=a.diff(o,"minute"),s=Math.floor(r/60);return s+"时"},dutyTypeFormat:function(e,t){var a=e[t.property];if(void 0==a)return"";switch(a){case 1:return"值班领导";case 2:return"值班组长";case 3:return"值班员"}},loadDutyTime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=new Date(this.form.schedulingDate+" 00:00:00");console.log(t),0==e&&t.setHours(t.getHours()+16);var a=new Date(t);0==e?a.setHours(a.getHours()+16):a.setHours(a.getHours()+24),this.value1[0]=t,this.value1[1]=a},handDutyPersons:function(){var e=this,t={pageSize:1e3};Object(i["C"])(t).then((function(t){console.log(t),e.personList=t.data}))},handSave:function(){var e=new Date(this.value1[0]),t=new Date(this.value1[1]);this.form.stime=Object(n["a"])(e,"yyyy-MM-dd hh:mm:ss"),this.form.etime=Object(n["a"])(t,"yyyy-MM-dd hh:mm:ss"),this.form.dutyType=parseInt(this.form.dutyType),this.SaveScheduling()},handDelete:function(e){var t=this;this.form.schedulingID=e.schedulingID,this.$confirm("删除后将不能恢复,是否继续?","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((function(){var e=[t.form.schedulingID],a={schedulingID:e};Object(i["o"])(a).then((function(e){1==e.status?(t.$message({message:"人员删除成功!",type:"success"}),t.refreshList()):t.$message({message:"人员删除失败!",type:"error"})}))}))},handReset:function(){this.form.schedulingID=void 0,this.form.dutyType="",this.form.stime="",this.form.etime="",this.form.personID=void 0,this.form.mobile=void 0},handLeaderChanged:function(e){var t=this;this.personList.map((function(a,o){console.log(a),a.personID!=e||(t.form.mobile=a.mobile)}))},pageSchedulingList:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=[],console.log("----------------------------"),console.log(e),t.next=5,Object(i["G"])(e).then((function(e){console.log(e),a=e.data}));case 5:return t.abrupt("return",a);case 6:case"end":return t.stop()}}),t)})))()},SaveScheduling:function(){var e=this;console.log("SaveScheduling"),console.log(this.form),Object(i["F"])(this.form).then((function(t){1==t.status?(e.$message({message:"增加值班人员成功!",type:"success"}),e.refreshList()):e.$message({message:"增加值班人员失败!",type:"error"})}))},dealMyDate:function(e){for(var t=this.resDate.length,a="",o=0;o<t;o++)if(this.resDate[o].date==e){a=this.resDate[o].content;break}return a}},created:function(){this.handDutyPersons(0),this.loadThisMoth()}},d=u,h=(a("2922"),a("2877")),m=Object(h["a"])(d,o,r,!1,null,null,null);t["default"]=m.exports},2922:function(e,t,a){"use strict";a("fa3a")},c466:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("4d63"),a("ac1f"),a("25f0"),a("5319");function o(e,t){var a=new Date(e).Format("yyyy-MM-dd hh:mm:ss");return t&&(a=new Date(e).Format(t)),a.toLocaleString()}Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e}},fa3a:function(e,t,a){}}]);