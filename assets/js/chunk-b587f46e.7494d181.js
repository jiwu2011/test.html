(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b587f46e"],{"13d5":function(e,t,a){"use strict";var r=a("23e7"),n=a("d58f").left,i=a("a640"),o=a("ae40"),s=a("2d00"),l=a("605d"),d=i("reduce"),c=o("reduce",{1:0}),u=!l&&s>79&&s<83;r({target:"Array",proto:!0,forced:!d||!c||u},{reduce:function(e){return n(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"580c":function(e,t,a){},"8a3f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search"},[a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:6}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"专家级别"}},[a("el-select",{attrs:{placeholder:"请选择专家级别"},model:{value:e.searchPars.expertGrade,callback:function(t){e.$set(e.searchPars,"expertGrade",t)},expression:"searchPars.expertGrade"}},e._l(e.grades,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"专家专业"}},[a("el-select",{attrs:{placeholder:"请选择专家专业",multiple:""},model:{value:e.searchPars.expertKind,callback:function(t){e.$set(e.searchPars,"expertKind",t)},expression:"searchPars.expertKind"}},e._l(e.data,(function(e){return a("el-option",{key:e.codeID,attrs:{label:e.codeName,value:e.codeID}})})),1)],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"专家姓名"}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.searchPars.expertName,callback:function(t){e.$set(e.searchPars,"expertName",t)},expression:"searchPars.expertName"}})],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handSearch}},[e._v("搜索")])],1)],1)],1)],1)],1),a("div",{staticClass:"content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:!0,data:e.tableData}},[a("el-table-column",{attrs:{prop:"expertGrade",label:"专家级别",width:"80",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.expertGrade(t.row))+" ")]}}])}),a("el-table-column",{attrs:{prop:"expertName",label:"专家姓名",width:"80",fixed:""}}),a("el-table-column",{attrs:{prop:"expertKindName",label:"专业",width:"140",fixed:""}}),a("el-table-column",{attrs:{prop:"company",label:"工作单位",width:"210"}}),a("el-table-column",{attrs:{prop:"expertTel",label:"联系电话",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("my-telephone",{attrs:{book:e.handLeaderTel(t.row)}})]}}])}),a("el-table-column",{attrs:{prop:"sex",label:"性别",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.SexName(t.row))+" ")]}}])}),a("el-table-column",{attrs:{prop:"education",label:"学历",width:"100"}}),a("el-table-column",{attrs:{prop:"post",label:"职位/职称",width:"100"}}),a("el-table-column",{attrs:{prop:"birth",label:"出生年月",width:"100"}}),a("el-table-column",{attrs:{prop:"liaisonName",label:"联络员",width:"100"}}),a("el-table-column",{attrs:{prop:"liaisonTel",label:"联系方式",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("my-telephone",{attrs:{book:e.handLeaderTel1(t.row)}})]}}])}),a("el-table-column",{attrs:{prop:"addr",label:"地址",width:"70"}})],1),a("el-pagination",{staticStyle:{"margin-top":"5px"},attrs:{background:"",layout:"total,prev, pager, next",total:e.total,"current-page":e.searchPars.pageIndex,"page-size":e.searchPars.pageSize},on:{"current-change":e.handPageIndexChanged}})],1)])},n=[],i=(a("4de4"),a("d81d"),a("13d5"),a("b0c0"),a("d3b7"),a("25f0"),a("c1df")),o=a.n(i),s=a("de9b"),l=a("cf45"),d=a("d80d"),c=a("7c15"),u={watch:{filterText:function(e){this.$refs.tree.filter(e)}},data:function(){return{layers:[],eventGis:{longitude:0,latitude:0,layerID:0,featureid:void 0},gis:{longitude:113.07329268615261,latitude:28.255592768842703,layerID:0,featureid:void 0},activeName:"first",sexes:[{label:"男",value:1},{label:"女",value:2},{label:"未知",value:0}],grades:[{label:"省级",value:1},{label:"市级",value:2},{label:"县级",value:3}],kinds:[],data:[],types:[],kindProps:{multiple:!0},treePars:{codeID:82,groupName:void 0,parentID:void 0,groupID:void 0,pageIndex:void 0,pageSize:1e3},searchPars:{expertName:void 0,expertGrade:void 0,expertKind:[],pageIndex:void 0,pageSize:10},total:0,saveForm:{personID:void 0,groupID:void 0,types:[],groupName:void 0,name:void 0,nameJP:void 0,duty:0,post:void 0,mobile:void 0,tel:void 0,email:void 0,fax:void 0,index:0,comment:void 0},dialogFormVisible:!1,formLabelWidth:"80px",leaders:[],form:{expertID:void 0,expertName:void 0,post:void 0,education:void 0,expertTel:void 0,company:void 0,sex:void 0,birth:void 0,expertKind:void 0,expertGrade:void 0,addr:void 0,longitude:113.07329268615261,latitude:28.255592768842703,layerID:0},tableData:[],treeData:[]}},components:{"my-map":s["a"],"my-telephone":d["a"]},methods:{handLeaderTel:function(e){return{display:!1,name:e.expertName,tel:e.expertTel,ts:new Date}},handLeaderTel1:function(e){return{display:!1,name:e.liaisonName,tel:e.liaisonTel,ts:new Date}},handGetMapLayer:function(){var e=this,t={type:"point"};Object(c["ac"])(t).then((function(t){var a=t.data,r=a.reduce((function(e,t){return e[t.id]=t,t.children=[],e}),{}),n=a.filter((function(e){return r[e.fid]&&r[e.fid].children.push(e),0==e.fid}));e.layers=n,console.log(n)}))},handMarked:function(e,t){this.form.longitude=e,this.form.latitude=t},handleClick:function(){"second"==this.activeName&&(this.eventGis.longitude=this.gis.longitude,this.eventGis.latitude=this.gis.latitude,this.eventGis.layerID=this.gis.layerID=this.form.layerID,console.log(this.eventGis))},expertGrade:function(e){return 1==e.expertGrade?"省级":2==e.expertGrade?"市级":3==e.expertGrade?"县级":void 0},SexName:function(e){return 1==e.sex?"男性":2==e.sex?"女性":"未知"},loadKinds:function(){var e=this,t={codeType:50};Object(c["c"])(t).then((function(t){e.kinds=t.data}))},loadTypes:function(){var e=this,t={codeType:1,pageSize:100};Object(c["c"])(t).then((function(t){var a=t.data,r=a.reduce((function(e,t){return e[t.codeID]=t,t.children=[],e}),{}),n=a.filter((function(e){return r[e.parentID]&&r[e.parentID].children.push(e),"-1"==e.parentID}));e.types=n}))},handContacts:function(e){return e.contacts},handOfficeContacts:function(e){var t=[];return e.officeTel.map((function(e,a){t.push({mobile:e})})),t},handAllContent:function(e,t){var a="";switch(t){case 1:a=e.teamType;var r="";return a.map((function(e,t){r+=e.codeName+","})),r;case 2:return a=e.teamName,a;case 3:return a=e.equipments,a}},handSubConent:function(e,t){var a="";switch(t){case 1:a=e.teamType;var r="";return a.map((function(e,t){r+=e.codeName+","})),r.length>10&&(r=r.substring(0,10)+"..."),r;case 2:return a=e.teamName,a.length>10&&(a=a.substring(0,10)+"..."),a;case 3:return a=e.equipments,null==a?"":(a.length>10&&(a=a.substring(0,10)+"..."),a);case 4:var n=e.contacts;return 0==n.length?"":n.length>1?n[0].name+"("+n[0].mobile+")...":n[0].name+"("+n[0].mobile+")";case 5:var i="";return e.officeTel.map((function(e,t){i+=e+","})),i}},handChange:function(e){var t=this,a=[];a.push(e);var r={groupID:a};Object(c["hb"])(r).then((function(e){t.leaders=[],e.data.data.map((function(e,a){return 0==e.duty&&t.leaders.push(e),void 0===e}))}))},handSearch:function(){var e=this;Object(c["Z"])(this.searchPars).then((function(t){console.log("ExpertList"),console.log(t.data),e.tableData=t.data,e.total=t.total}))},handPageIndexChanged:function(e){this.searchPars.pageIndex=e,this.handSearch()},handLeaderChanged:function(e){var t=this;this.leaders.map((function(a,r){if(a.personID==e)return t.form.personID=e,t.form.mobile=a.mobile,void(t.form.post=a.post)}))},handSave:function(){this.handSaveTeam()},handNew:function(){this.form.expertID=void 0,this.form.expertName=void 0,this.form.addr=void 0,this.form.post=void 0,this.form.education=void 0,this.form.expertTel=void 0,this.form.company=void 0,this.form.sex=0,this.form.birth=new Date,this.form.expertKind=void 0,this.form.expertGrade=void 0},handEdit:function(e){this.handNew(),this.form.expertID=e.expertID,this.form.expertName=e.expertName,this.form.addr=e.addr,this.form.post=e.post,this.form.education=e.education,this.form.expertTel=e.expertTel,this.form.company=e.company,this.form.sex=parseInt(e.sex),this.form.birth=e.birth,this.form.expertKind=e.expertKind,this.form.expertGrade=parseInt(e.expertGrade),this.dialogFormVisible=!0,this.form.layerID=parseInt(e.layerID),this.form.longitude=e.longitude,this.form.latitude=e.latitude},handDel:function(e){var t=this;this.$confirm("删除后将不能恢复,是否继续?","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[e.expertID],r={ids:a};Object(c["U"])(r).then((function(e){1==e.status?(t.$message({message:"应急专家删除成功!",type:"success"}),t.handSearch()):t.$message({message:"应急专家删除失败!",type:"error"})}))}))},handSaveTeam:function(){var e=this;console.log(this.form),this.form.birth=o()(this.form.birth).format("YYYY-MM-DD"),this.form.sex=parseInt(this.form.sex),this.form.expertGrade=parseInt(this.form.expertGrade),this.form.layerID=this.form.layerID.toString(),Object(c["ab"])(this.form).then((function(t){1==t.status?(e.form.expertID=t.data,Object(l["a"])(parseFloat(e.form.longitude),parseFloat(e.form.latitude),parseInt(e.form.layerID),e.form.expertID,e.form.expertName),e.$message({message:"保存应急专家成功!",type:"success"}),e.handSearch(),e.dialogFormVisible=!1):e.$message({message:"保存应急专家失败!",type:"error"})}))},getGroups:function(){var e=this,t={codeType:14,pageSize:200};Object(c["c"])(t).then((function(t){var a=t.data,r=a.reduce((function(e,t){return e[t.codeID]=t,t.children=[],e}),{}),n=a.filter((function(e){return r[e.parentID]&&r[e.parentID].children.push(e),"-1"==e.parentID}));e.data=n}))}},created:function(){this.loadKinds(),this.loadTypes(),this.handSearch()},mounted:function(){this.getGroups(),this.handGetMapLayer()}},h=u,p=(a("dc58"),a("2877")),f=Object(p["a"])(h,r,n,!1,null,"56d7bc5a",null);t["default"]=f.exports},"8add":function(e,t,a){},b205:function(e,t,a){"use strict";a("8add")},b85c:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0");var r=a("06c5");function n(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=Object(r["a"])(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(l)throw o}}}}},cf45:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("7c15");function n(e,t,a,n,i){var o={layercode:parseInt(a),latitude:parseFloat(t),longitude:parseFloat(e),featureid:n,label:i,minzoom:0};console.log("gid->save->",o),Object(r["wb"])(o).then((function(e){console.log("gid->save->",o,"--\x3e",e)}))}},d58f:function(e,t,a){var r=a("1c0b"),n=a("7b0b"),i=a("44ad"),o=a("50c4"),s=function(e){return function(t,a,s,l){r(a);var d=n(t),c=i(d),u=o(d.length),h=e?u-1:0,p=e?-1:1;if(s<2)while(1){if(h in c){l=c[h],h+=p;break}if(h+=p,e?h<0:u<=h)throw TypeError("Reduce of empty array with no initial value")}for(;e?h>=0:u>h;h+=p)h in c&&(l=a(l,c[h],h,d));return l}};e.exports={left:s(!1),right:s(!0)}},dc58:function(e,t,a){"use strict";a("580c")},de9b:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"50vh"}},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("div",{attrs:{id:"all"}},[a("div",{staticClass:"searchMap"},[a("el-autocomplete",{staticClass:"input-with",staticStyle:{width:"300px"},attrs:{id:"search-input",placeholder:"请输入地址",size:"mini","fetch-suggestions":e.querySearchAsync},on:{change:e.loadSearchResult,select:e.handleAddrSelect},model:{value:e.search_addr,callback:function(t){e.search_addr=t},expression:"search_addr"}}),a("el-button",{staticStyle:{border:"1px"},on:{click:e.handPoint}},[e._v("标记")])],1),a("div",{ref:"map",staticClass:"map",attrs:{id:"commonMap"}})])])],1)},n=[],i=(a("c975"),a("d81d"),a("b0c0"),a("ac1f"),a("1276"),a("b85c")),o=a("600f"),s={data:function(){return{search_addr:"",longitude:0,latitude:0,layerID:999,map:void 0,label:"",resultArr:[],resultList:[]}},props:["gisInfo"],watch:{gisInfo:{immediate:!0,deep:!0,handler:function(e){console.log("----------------------"),console.log(e),this.longitude=e.longitude,this.latitude=e.latitude,this.layerID=e.layerID,this.handInitMap(),this.$forceUpdate()}},search_addr:{deep:!0,handler:function(e,t){this.resultArr=[];for(var a=this.resultList.length,r=[],n=0;n<a;n++)this.resultList[n].value.indexOf(this.search_addr)>=0&&r.push({value:this.resultList[n].value,id:this.resultList[n].id,longitude:this.resultList[n].longitude,latitude:this.resultList[n].latitude});this.resultArr=r}}},methods:{handPoint:function(){var e=this;o["a"].add_point(this.map,999,999,null,"").then((function(t){e.$emit("marked",t[0],t[1])}))},searchMap:function(){var e=this;if(o["a"].delete_draw(this.map,"search"),o["a"].delete_draw(this.map,"center"),""!=this.search_addr){var t=0,a=0;o["a"].local_search(this.map.getLayers().getArray()[0],this.search_addr,!1).then((function(r){if(r.length>0){var n=r[0].location,i=n.split(","),s=o["a"].gaode_gcs(i);s&&2==s.length&&(t=s[0],a=s[1],o["a"].center_display(parseFloat(t),parseFloat(a),200,e.map))}}))}},loadSearchResult:function(){var e=this;this.resultList=[],this.resultArr=[],o["a"].local_search(this.map.getLayers().getArray()[0],this.search_addr,!1).then((function(t){if(t.length>0)for(var a=0;a<t.length;a++){var r=t[a].location,n=r.split(","),s=o["a"].gaode_gcs(n),l=0,d=0;s&&2==s.length&&(l=s[0],d=s[1]),e.resultList.push({value:t[a].name+"("+t[a].address+")",id:t[a].id,longitude:l,latitude:d})}var c,u=Object(i["a"])(e.resultList);try{for(u.s();!(c=u.n()).done;){var h=c.value;e.resultArr.push({value:h.value,id:h.id,longitude:h.longitude,latitude:h.latitude})}}catch(p){u.e(p)}finally{u.f()}}))},querySearchAsync:function(e,t){var a=this.resultArr;t(a)},handleAddrSelect:function(e){o["a"].center_display(parseFloat(e.longitude),parseFloat(e.latitude),200,this.map)},handInitMap:function(){var e=this;setTimeout((function(){void 0!=e.$refs.map&&(void 0==e.map?(console.log("created"),e.map=o["a"].set_map("commonMap",!1,!1,!1,!1,!1),o["a"].add_baselayers(e.map),o["a"].set_layers(e.map).then((function(t){o["a"].add_one_layer_featurelist(e.map,parseInt(e.layerID),[]),o["a"].open_levels(!1,e.map),e.longitude>0?o["a"].center_display(e.longitude,e.latitude,50,e.map):o["a"].center_display(113.07329268615261,28.255592768842703,500,e.map)}))):(console.log("created1"),o["a"].delete_layer_features(e.map,[]),o["a"].cancel_draw(e.map,"get_extent"),o["a"].cancel_draw(e.map,"add_feature"),o["a"].delete_draw(e.map,"range"),o["a"].delete_draw(e.map,"center"),o["a"].set_layers(e.map).then((function(t){o["a"].add_one_layer_featurelist(e.map,parseInt(e.layerID),[]),o["a"].open_levels(!1,e.map),e.longitude>0?(o["a"].center_display(e.longitude,e.latitude,500,e.map),o["a"].delete_draw(e.map,"center")):o["a"].center_display(113.07329268615261,28.255592768842703,500,e.map)}))))}),500)}},mounted:function(){}},l=s,d=(a("b205"),a("2877")),c=Object(d["a"])(l,r,n,!1,null,"6cd33be4",null);t["a"]=c.exports}}]);