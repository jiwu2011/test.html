(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6947eeba"],{"13d5":function(e,t,a){"use strict";var s=a("23e7"),r=a("d58f").left,o=a("a640"),i=a("ae40"),n=a("2d00"),l=a("605d"),c=o("reduce"),d=i("reduce",{1:0}),m=!l&&n>79&&n<83;s({target:"Array",proto:!0,forced:!c||!d||m},{reduce:function(e){return r(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"562a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.dialogFormVisible,"show-close":!0,width:e.width,top:"5vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("template",{slot:"title"},[a("div",{staticStyle:{"font-size":"14px",color:"blue","font-weight":"bold",padding:"0","padding-left":"5px","line-height":"25px"}},[e._v("预案详细信息")])]),a("template",{slot:"title"}),a("el-tabs",{staticStyle:{margin:"0",padding:"0"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"first"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-date"}),e._v(" 预案信息")]),a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("预案名称：")])]),a("el-col",{attrs:{span:15}},[a("div",{staticClass:"grid-content bg-purple-light"},[e._v("企业应急预案")])])],1),a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("备案号：")])]),a("el-col",{attrs:{span:15}},[a("div",{staticClass:"grid-content bg-purple-light"},[e._v("企业应急预案")])])],1),a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("发布单位：")])]),a("el-col",{attrs:{span:15}},[a("div",{staticClass:"grid-content bg-purple-light"},[e._v("企业应急预案")])])],1),a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("备案时间：")])]),a("el-col",{attrs:{span:15}},[a("div",{staticClass:"grid-content bg-purple-light"},[e._v("企业应急预案")])])],1),a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("附件：")])]),a("el-col",{attrs:{span:15}},[a("div",{staticClass:"grid-content bg-purple-light",staticStyle:{height:"50px"}},[a("a",{attrs:{href:"#"}},[e._v("附件1")]),e._v(" "),a("a",{attrs:{href:"#"}},[e._v("附件2")])])])],1)],1),a("el-tab-pane",{attrs:{name:"second"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-edit"}),e._v(" 应急队伍")]),a("el-form",{attrs:{model:e.form}},[a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:11}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"续报时间"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.continueReportForm.resubmitTime,callback:function(t){e.$set(e.continueReportForm,"resubmitTime",t)},expression:"continueReportForm.resubmitTime"}})],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:24}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"续报内容"}},[a("el-input",{attrs:{type:"textarea",placeholder:"续报内容"},model:{value:e.continueReportForm.comment,callback:function(t){e.$set(e.continueReportForm,"comment",t)},expression:"continueReportForm.comment"}})],1)],1)],1)],1)],1)],1),a("el-row",{staticClass:"el-row1"},[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:24}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"续报原文"}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"https://jsonplaceholder.typicode.com/posts/",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])])],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:10}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit-outline",round:""},on:{click:e.SaveEmergencyResubmit}},[e._v("保存")]),a("el-button",{attrs:{type:"warning",icon:"el-icon-close",round:""}},[e._v("关闭")])],1)],1)],1)],1)],1)],1),a("el-tab-pane",{attrs:{name:"third"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-chat-line-square"}),e._v(" 应急物资")])]),a("el-tab-pane",{attrs:{name:"mapLoation"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-map-location"}),e._v(" 企业信息")]),a("div",{ref:"locationMap",staticClass:"map",attrs:{id:"locationMap"}})])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],2),a("div",{staticClass:"search"},[a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:6}},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"预案名称"}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.searchPars.post,callback:function(t){e.$set(e.searchPars,"post",t)},expression:"searchPars.post"}})],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"预案编号"}},[a("el-cascader",{attrs:{options:e.eventTreedata,props:e.props,"collapse-tags":"",clearable:""}})],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"发布公司"}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.searchPars.post,callback:function(t){e.$set(e.searchPars,"post",t)},expression:"searchPars.post"}})],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handSearch}},[e._v("搜索")])],1)],1)],1)],1)],1),a("div",{staticClass:"content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"recordNumber",label:"预案编号",fixed:"",width:"100"}}),a("el-table-column",{attrs:{prop:"emergencyName",label:"预案名称",fixed:"",width:"220"}}),a("el-table-column",{attrs:{prop:"companyName",label:"发布公司",width:"180"}}),a("el-table-column",{attrs:{prop:"emergencyTime",label:"备案时间",width:"150"}}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){return e.handEdit(t.row)}}},[e._v("查看")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"5px"},attrs:{background:"",layout:"total,prev, pager, next",total:e.total,"current-page":e.searchPars.pageIndex,"page-size":e.searchPars.pageSize},on:{"current-change":e.handPageIndexChanged}})],1)],1)},r=[],o=(a("4de4"),a("d81d"),a("13d5"),a("600f")),i=a("c1df"),n=a.n(i),l=a("7c15"),c={watch:{filterText:function(e){this.$refs.tree.filter(e)}},data:function(){return{props:{multiple:!0,label:"codeName",value:"codeID",children:"children"},activeName:"first",value1:[new Date,new Date],width:"650px",renderComponent:!0,data:[],teamData:[],resourceData:[],companyInfo:void 0,map:void 0,eventTreedata:[],sourceTreedata:[],eventTreePars:{codeType:7,pageSize:1e3},treePars:{codeID:78,groupName:void 0,parentID:void 0,groupID:void 0,pageIndex:void 0,pageSize:1e3},searchPars:{planType:3,post:void 0,pageIndex:void 0,pageSize:10},total:0,continueReportForm:{resubmitID:void 0,emergencyID:void 0,resubmitTime:void 0,comment:void 0},baseEventForm:{emergencyID:void 0,reportType:void 0,reportName:void 0,eventName:void 0,tel:void 0,addr:void 0,eventTime:void 0,reportTime:void 0,kind:void 0,comment:void 0,trappedNum:0,injuriesNum:0,injuredNum:0,missingNum:0,deathNum:0,directLoss:0,indirectLoss:0,houseDown:0,carDamage:0,burnedArea:0,userid:"admin",status:0},saveForm:{personID:void 0,groupID:void 0,groupName:void 0,name:void 0,nameJP:void 0,duty:0,post:void 0,mobile:void 0,tel:void 0,email:void 0,fax:void 0,index:0,comment:void 0},dialogFormVisible:!1,formLabelWidth:"80px",leaders:[],form:{dutyPersonID:void 0,personID:void 0,groupID:void 0,index:0,post:void 0,mobile:void 0},tableData:[],treeData:[]}},methods:{handleClick:function(e,t){var a=this;console.log(e,t),console.log(this.activeName),"mapLoation"==this.activeName&&setTimeout((function(){a.map=o["a"].set_map("locationMap",!1,!1,!1,!1),o["a"].add_baselayers(a.map),o["a"].add_one_layer_featurelist(a.map,3,[]),o["a"].open_levels(!1,a.map)}),200)},handChange:function(e){var t=this,a=[];a.push(e);var s={groupID:a};Object(l["hb"])(s).then((function(e){t.leaders=[],e.data.data.map((function(e,a){return 0==e.duty&&t.leaders.push(e),void 0===e}))}))},getKinds:function(){var e=this;Object(l["c"])(this.eventTreePars).then((function(t){var a=t.data,s=a.reduce((function(e,t){return e[t.codeID]=t,t.children=[],e}),{}),r=a.filter((function(e){return s[e.parentID]&&s[e.parentID].children.push(e),"-1"==e.parentID}));e.eventTreedata=r}))},dateFormat:function(e,t){var a=e[t.property];return void 0==a?"":n()(a).format("MM-DD hh:mm")},getSource:function(){var e=this;this.eventTreePars.codeType=80,Object(l["c"])(this.eventTreePars).then((function(t){var a=t.data,s=a.reduce((function(e,t){return e[t.codeID]=t,t.children=[],e}),{}),r=a.filter((function(e){return s[e.parentID]&&s[e.parentID].children.push(e),"-1"==e.parentID}));e.sourceTreedata=r}))},handSearch:function(){var e=this;console.log(this.searchPars),Object(l["P"])(this.searchPars).then((function(t){console.log(t),e.tableData=t.data,e.total=t.total}))},handPageIndexChanged:function(e){this.searchPars.pageIndex=e,this.handSearch()},handLeaderChanged:function(e){var t=this;this.leaders.map((function(a,s){if(a.personID==e)return t.form.personID=e,t.form.mobile=a.mobile,void(t.form.post=a.post)}))},handSave:function(){this.SaveDutyPerson()},handReset:function(){this.baseEventForm.emergencyID=void 0,this.baseEventForm.reportType=void 0,this.baseEventForm.reportName=void 0,this.baseEventForm.tel=void 0,this.baseEventForm.addr=void 0,this.baseEventForm.eventTime=n()(new Date).add("minutes",-30),this.baseEventForm.reportTime=new Date,this.baseEventForm.kind=void 0,this.baseEventForm.comment=void 0,this.baseEventForm.trappedNum=0,this.baseEventForm.injuriesNum=0,this.baseEventForm.injuredNum=0,this.baseEventForm.missingNum=0,this.baseEventForm.deathNum=0,this.baseEventForm.directLoss=0,this.baseEventForm.houseDown=0,this.baseEventForm.carDamage=0,this.baseEventForm.burnedArea=0,this.baseEventForm.status},handInit:function(e){this.baseEventForm.emergencyID=e.emergencyID,this.baseEventForm.reportType=e.reportType,this.baseEventForm.reportName=e.reportName,this.baseEventForm.tel=e.tel,this.baseEventForm.addr=e.addr,this.baseEventForm.eventTime=e.eventTime,this.baseEventForm.reportTime=e.reportTime,this.baseEventForm.kind=e.kind,this.baseEventForm.comment=e.comment,this.baseEventForm.trappedNum=e.trappedNum,this.baseEventForm.injuriesNum=e.injuriesNum,this.baseEventForm.injuredNum=e.injuredNum,this.baseEventForm.missingNum=e.missingNum,this.baseEventForm.deathNum=e.deathNum,this.baseEventForm.directLoss=e.directLoss,this.baseEventForm.houseDown=e.houseDown,this.baseEventForm.carDamage=e.carDamage,this.baseEventForm.burnedArea=e.burnedArea,this.baseEventForm.status,e.status},handNew:function(){this.handReset(),this.dialogFormVisible=!0},handClose:function(){var e=this;this.$confirm("是否确认关闭窗口?","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((function(){e.dialogFormVisible=!1}))},handEdit:function(e){this.handInit(e),this.activeName="first",this.dialogFormVisible=!0},handContinueReport:function(e){this.handInit(e),this.activeName="second",this.continueReportForm.resubmitTime=new Date,this.continueReportForm.emergencyID=this.baseEventForm.emergencyID,this.dialogFormVisible=!0},handDel:function(e){var t=this;this.baseEventForm.emergencyID=e.emergencyID,this.$confirm("删除后将不能恢复,是否继续?","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((function(){var e=[t.form.dutyPersonID],a={ids:e};Object(l["B"])(a).then((function(e){1==e.status?(t.$message({message:"人员删除成功!",type:"success"}),t.handSearch()):t.$message({message:"人员删除失败!",type:"error"})}))}))},SaveEmergencyResubmit:function(){var e=this;Object(l["Q"])(this.continueReportForm).then((function(t){1==t.status?(e.continueReportForm.resubmitID=t.data,e.$message({message:"保存突发事件续报信息成功!",type:"success"})):e.$message({message:"保存突发事件续报信息失败!",type:"error"})}))},SaveDutySudden:function(){var e=this;this.baseEventForm.deathNum=parseInt(this.baseEventForm.deathNum),console.log(this.baseEventForm),this.baseEventForm.eventTime=n()(this.baseEventForm.eventTime).format("YYYY-MM-DD hh:mm:ss"),this.baseEventForm.reportTime=n()(this.baseEventForm.reportTime).format("YYYY-MM-DD hh:mm:ss"),Object(l["H"])(this.baseEventForm).then((function(t){1==t.status?(e.baseEventForm.emergencyID=t.data,e.$message({message:"保存突发事件信息成功!",type:"success"}),e.handSearch()):e.$message({message:"保存突发事件信息失败!",type:"error"})}))},getGroups:function(){var e=this;Object(l["Wb"])(this.treePars).then((function(t){var a=t.data,s=a.reduce((function(e,t){return e[t.groupID]=t,t.children=[],e}),{}),r=a.filter((function(e){return s[e.parentID]&&s[e.parentID].children.push(e),"-1"==e.parentID}));e.data=r}))}},created:function(){this.handSearch(),this.getKinds(),this.getSource()},mounted:function(){this.getGroups()}},d=c,m=(a("c072"),a("2877")),p=Object(m["a"])(d,s,r,!1,null,"eb884c00",null);t["default"]=p.exports},7576:function(e,t,a){},c072:function(e,t,a){"use strict";a("7576")},d58f:function(e,t,a){var s=a("1c0b"),r=a("7b0b"),o=a("44ad"),i=a("50c4"),n=function(e){return function(t,a,n,l){s(a);var c=r(t),d=o(c),m=i(c.length),p=e?m-1:0,u=e?-1:1;if(n<2)while(1){if(p in d){l=d[p],p+=u;break}if(p+=u,e?p<0:m<=p)throw TypeError("Reduce of empty array with no initial value")}for(;e?p>=0:m>p;p+=u)p in d&&(l=a(l,d[p],p,c));return l}};e.exports={left:n(!1),right:n(!0)}}}]);