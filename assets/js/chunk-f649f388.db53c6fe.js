(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f649f388"],{"48c8":function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return o})),a.d(e,"b",(function(){return l}));a("a18c"),a("4360");var n=a("b775");function i(t){return Object(n["a"])({url:"/yjzh/RiskCensus/list",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/yjzh/RiskCensus",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/yjzh/RiskCensus/detail",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/yjzh/RiskCensus/category/list",method:"post",data:t})}},6793:function(t,e,a){"use strict";a("e0cd")},"8add":function(t,e,a){},ac37:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"地图标绘",visible:t.editDialogVisible,width:"700px",height:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.editDialogVisible=e}}},[a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:3}},[t._v("经度:")]),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"经度"},model:{value:t.GisInfo.longitude,callback:function(e){t.$set(t.GisInfo,"longitude",e)},expression:"GisInfo.longitude"}})],1),a("el-col",{attrs:{span:3}},[t._v("纬度:")]),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"纬度"},model:{value:t.GisInfo.latitude,callback:function(e){t.$set(t.GisInfo,"latitude",e)},expression:"GisInfo.latitude"}})],1),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handSaveGis}},[t._v("保存")])],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:24}},[a("my-map",{attrs:{gisInfo:t.gis},on:{marked:t.handmarked}})],1)],1)],1)],1)],1),a("div",{staticClass:"search"},[a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:8}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"普查结果分类"}},[a("el-select",{attrs:{placeholder:"请选择普查结果分类"},model:{value:t.searchPars.categoryCode,callback:function(e){t.$set(t.searchPars,"categoryCode",e)},expression:"searchPars.categoryCode"}},t._l(t.types,(function(t){return a("el-option",{key:t.category_code,attrs:{label:t.table_chinese_name,value:t.category_code}})})),1)],1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"地点名称"}},[a("el-input",{attrs:{placeholder:"请输入地点名称"},model:{value:t.searchPars.name,callback:function(e){t.$set(t.searchPars,"name",e)},expression:"searchPars.name"}})],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:t.loadLog}},[t._v("搜索")])],1)],1)],1)],1)],1),a("div",{staticClass:"content"},[a("el-table",{ref:"multipleTable",staticStyle:{"padding-top":"10px"},attrs:{"header-cell-style":{background:"#66b1ff",color:"#fff",border:"1px solid #fff"},"tooltip-effect":"dark",data:t.logs}},[t._l(t.columns,(function(e,n){return a("el-table-column",{key:e.key,attrs:{prop:e.value,label:t.subContent(e.label),fixed:n<3},scopedSlots:t._u([{key:"default",fn:function(n){return[a("el-tooltip",{attrs:{placement:"top",effect:"dark"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(t.handAllContent(n.row,e.value)))])]),a("span",[t._v(t._s(t.handSubConent(n.row,e.value)))])])]}}],null,!0)})})),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){return t.handEditLog(e.row)}}},[t._v("地图标绘")])]}}])})],2),a("el-pagination",{staticStyle:{"margin-top":"5px"},attrs:{background:"",layout:"total,prev, pager, next",total:t.total,"current-page":t.searchPars.pageIndex,"page-size":t.searchPars.pageSize},on:{"current-change":t.handPageIndexChanged}})],1)],1)},i=[],s=(a("d81d"),a("b0c0"),a("53ca")),o=a("48c8"),l=a("c1df"),r=a.n(l),d=a("de9b"),c=a("cf45"),u={data:function(){return{value1:[],columns:[],LogInfo:{ts:void 0,logID:void 0,logInfo:void 0},types:[],currIndex:void 0,dialogVisible:!1,editDialogVisible:!1,tableLoading:!1,pars:{stime:void 0,etime:void 0},searchPars:{stime:"2021-01-01 00:00:00",etime:"2022-06-01 00:00:00",pageindex:1,pagesize:10,categoryCode:"01",name:void 0},GisInfo:{longitude:void 0,latitude:void 0,layerID:void 0,categoryCode:void 0,id:void 0,name:void 0},logForm:{eventLogID:void 0,date:void 0,weather:void 0,leader:void 0,staff:void 0,items:void 0,eventlist:[],eventlist1:[],eventlist2:[]},gis:{longitude:void 0,latitude:void 0,layerID:void 0,ts:void 0},logs:[],total:0,index:0,salaries:[],multipleSelection:[],salary:{id:"",createDate:"",basicSalary:"",trafficSalary:"",lunchSalary:"",bonus:"",pensionBase:"",pensionPer:"",medicalBase:"",medicalPer:"",accumulationFundBase:"",accumulationFundPer:""}}},components:{"my-map":d["a"]},methods:{subContent:function(t){return t.length>4?t.substring(0,4):t},handSaveGis:function(){var t=this;Object(c["a"])(parseFloat(this.GisInfo.longitude),parseFloat(this.GisInfo.latitude),parseInt(this.GisInfo.layerID),this.GisInfo.id,this.GisInfo.name),Object(o["a"])({categoryCode:this.GisInfo.categoryCode,id:parseInt(this.GisInfo.id),longitude:parseFloat(this.GisInfo.longitude),latitude:parseFloat(this.GisInfo.latitude)}).then((function(e){t.$message({message:"保存成功!",type:"success"}),t.dialogVisible=t.editDialogVisible=!1,t.loadLog()})),this.dialogFormVisible=!1},handmarked:function(t,e){this.GisInfo.longitude=t,this.GisInfo.latitude=e},handAllContent:function(t,e){return t[e]},handSubConent:function(t,e){var a=t[e],n=Object(s["a"])(a);return"string"==n&&a.length>5&&(a=a.substring(0,6)+"..."),a},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":r()(a).format("YYYY-MM-DD")},handEditLog:function(t){this.gis.longitude=t.longitude,this.gis.latitude=t.latitude,this.gis.layerID=t.layerID,this.gis.ts=r()(),this.GisInfo.longitude=t.longitude,this.GisInfo.latitude=t.latitude,this.GisInfo.layerID=t.layerID,this.GisInfo.categoryCode=this.searchPars.categoryCode,this.GisInfo.name=t.name,this.GisInfo.id=t.id,this.editDialogVisible=!0},handPageIndexChanged:function(t){console.log("val->",t),this.searchPars.pageindex=t,this.loadLog()},loadLog:function(){var t=this;this.searchPars.stime=r()(this.value1[0]).format("YYYY-MM-DD"),this.searchPars.etime=r()(this.value1[1]).format("YYYY-MM-DD"),Object(o["d"])(this.searchPars).then((function(e){t.columns=[],console.log("list->",e);var a=e.fields;a.map((function(e){1==e.is_visible&&t.columns.push({label:e.column_chinese_name,value:e.column_name})})),t.logs=e.data,t.total=e.total,setTimeout((function(){t.$refs.multipleTable.doLayout()}),1200)}))},loadTypes:function(){var t=this;Object(o["b"])({}).then((function(e){console.log("types->",e),t.types=e.data}))}},mounted:function(){var t=[],e=r()().add("month",0).format("YYYY-MM")+"-01",a=r()(e).format("YYYY-MM-DD HH:mm:ss"),n=r()(e).add("month",1).add("days",-1).format("YYYY-MM-DD 23:59:59");t.push(a),t.push(n),this.value1=t,this.loadTypes(),this.loadLog()}},h=u,f=(a("6793"),a("2877")),p=Object(f["a"])(h,n,i,!1,null,"57df5d86",null);e["default"]=p.exports},b205:function(t,e,a){"use strict";a("8add")},b85c:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0");var n=a("06c5");function i(t,e){var a;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=Object(n["a"])(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,r=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return l=t.done,t},e:function(t){r=!0,o=t},f:function(){try{l||null==a["return"]||a["return"]()}finally{if(r)throw o}}}}},cf45:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var n=a("7c15");function i(t,e,a,i,s){var o={layercode:parseInt(a),latitude:parseFloat(e),longitude:parseFloat(t),featureid:i,label:s,minzoom:0};console.log("gid->save->",o),Object(n["wb"])(o).then((function(t){console.log("gid->save->",o,"--\x3e",t)}))}},de9b:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"50vh"}},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("div",{attrs:{id:"all"}},[a("div",{staticClass:"searchMap"},[a("el-autocomplete",{staticClass:"input-with",staticStyle:{width:"300px"},attrs:{id:"search-input",placeholder:"请输入地址",size:"mini","fetch-suggestions":t.querySearchAsync},on:{change:t.loadSearchResult,select:t.handleAddrSelect},model:{value:t.search_addr,callback:function(e){t.search_addr=e},expression:"search_addr"}}),a("el-button",{staticStyle:{border:"1px"},on:{click:t.handPoint}},[t._v("标记")])],1),a("div",{ref:"map",staticClass:"map",attrs:{id:"commonMap"}})])])],1)},i=[],s=(a("c975"),a("d81d"),a("b0c0"),a("ac1f"),a("1276"),a("b85c")),o=a("600f"),l={data:function(){return{search_addr:"",longitude:0,latitude:0,layerID:999,map:void 0,label:"",resultArr:[],resultList:[]}},props:["gisInfo"],watch:{gisInfo:{immediate:!0,deep:!0,handler:function(t){console.log("----------------------"),console.log(t),this.longitude=t.longitude,this.latitude=t.latitude,this.layerID=t.layerID,this.handInitMap(),this.$forceUpdate()}},search_addr:{deep:!0,handler:function(t,e){this.resultArr=[];for(var a=this.resultList.length,n=[],i=0;i<a;i++)this.resultList[i].value.indexOf(this.search_addr)>=0&&n.push({value:this.resultList[i].value,id:this.resultList[i].id,longitude:this.resultList[i].longitude,latitude:this.resultList[i].latitude});this.resultArr=n}}},methods:{handPoint:function(){var t=this;o["a"].add_point(this.map,999,999,null,"").then((function(e){t.$emit("marked",e[0],e[1])}))},searchMap:function(){var t=this;if(o["a"].delete_draw(this.map,"search"),o["a"].delete_draw(this.map,"center"),""!=this.search_addr){var e=0,a=0;o["a"].local_search(this.map.getLayers().getArray()[0],this.search_addr,!1).then((function(n){if(n.length>0){var i=n[0].location,s=i.split(","),l=o["a"].gaode_gcs(s);l&&2==l.length&&(e=l[0],a=l[1],o["a"].center_display(parseFloat(e),parseFloat(a),200,t.map))}}))}},loadSearchResult:function(){var t=this;this.resultList=[],this.resultArr=[],o["a"].local_search(this.map.getLayers().getArray()[0],this.search_addr,!1).then((function(e){if(e.length>0)for(var a=0;a<e.length;a++){var n=e[a].location,i=n.split(","),l=o["a"].gaode_gcs(i),r=0,d=0;l&&2==l.length&&(r=l[0],d=l[1]),t.resultList.push({value:e[a].name+"("+e[a].address+")",id:e[a].id,longitude:r,latitude:d})}var c,u=Object(s["a"])(t.resultList);try{for(u.s();!(c=u.n()).done;){var h=c.value;t.resultArr.push({value:h.value,id:h.id,longitude:h.longitude,latitude:h.latitude})}}catch(f){u.e(f)}finally{u.f()}}))},querySearchAsync:function(t,e){var a=this.resultArr;e(a)},handleAddrSelect:function(t){o["a"].center_display(parseFloat(t.longitude),parseFloat(t.latitude),200,this.map)},handInitMap:function(){var t=this;setTimeout((function(){void 0!=t.$refs.map&&(void 0==t.map?(console.log("created"),t.map=o["a"].set_map("commonMap",!1,!1,!1,!1,!1),o["a"].add_baselayers(t.map),o["a"].set_layers(t.map).then((function(e){o["a"].add_one_layer_featurelist(t.map,parseInt(t.layerID),[]),o["a"].open_levels(!1,t.map),t.longitude>0?o["a"].center_display(t.longitude,t.latitude,50,t.map):o["a"].center_display(113.07329268615261,28.255592768842703,500,t.map)}))):(console.log("created1"),o["a"].delete_layer_features(t.map,[]),o["a"].cancel_draw(t.map,"get_extent"),o["a"].cancel_draw(t.map,"add_feature"),o["a"].delete_draw(t.map,"range"),o["a"].delete_draw(t.map,"center"),o["a"].set_layers(t.map).then((function(e){o["a"].add_one_layer_featurelist(t.map,parseInt(t.layerID),[]),o["a"].open_levels(!1,t.map),t.longitude>0?(o["a"].center_display(t.longitude,t.latitude,500,t.map),o["a"].delete_draw(t.map,"center")):o["a"].center_display(113.07329268615261,28.255592768842703,500,t.map)}))))}),500)}},mounted:function(){}},r=l,d=(a("b205"),a("2877")),c=Object(d["a"])(r,n,i,!1,null,"6cd33be4",null);e["a"]=c.exports},e0cd:function(t,e,a){}}]);