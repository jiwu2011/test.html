(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f8123b8"],{"13d5":function(e,t,r){"use strict";var o=r("23e7"),a=r("d58f").left,l=r("a640"),n=r("ae40"),s=r("2d00"),i=r("605d"),c=l("reduce"),d=n("reduce",{1:0}),p=!i&&s>79&&s<83;o({target:"Array",proto:!0,forced:!c||!d||p},{reduce:function(e){return a(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"8b08":function(e,t,r){},baa5:function(e,t,r){var o=r("23e7"),a=r("e58c");o({target:"Array",proto:!0,forced:a!==[].lastIndexOf},{lastIndexOf:a})},d12e:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("template",{slot:"title"},[r("div",{staticStyle:{"font-size":"14px",color:"blue","font-weight":"bold"}},[e._v("保存专项应急成员单位")])]),r("el-form",{attrs:{model:e.form}},[r("el-row",[r("el-col",{attrs:{span:24,offset:0}},[r("el-row",{attrs:{gutter:40}},[r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{"label-width":"90px"}},[r("el-form-item",{attrs:{label:"所属专项"}},[r("el-select",{attrs:{placeholder:"请选择所属专项"},model:{value:e.form.kindID,callback:function(t){e.$set(e.form,"kindID",t)},expression:"form.kindID"}},e._l(e.projects,(function(e){return r("el-option",{key:e.codeID,attrs:{label:e.codeName,value:e.codeID}})})),1)],1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{"label-width":"90px"}},[r("el-form-item",{attrs:{label:"成员单位"}},[r("el-cascader",{attrs:{placeholder:"成员单位",options:e.data,props:{label:"groupName",value:"groupID",children:"children",checkStrictly:!0,emitPath:!1},filterable:""},on:{change:e.handChange},model:{value:e.form.leaderGroupID,callback:function(t){e.$set(e.form,"leaderGroupID",t)},expression:"form.leaderGroupID"}})],1)],1)],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24,offset:0}},[r("el-row",{attrs:{gutter:40}},[r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{"label-width":"90px"}},[r("el-form-item",{attrs:{label:"值班电话"}},[r("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.form.officeTel,callback:function(t){e.$set(e.form,"officeTel",t)},expression:"form.officeTel"}})],1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{"label-width":"90px"}},[r("el-form-item",{attrs:{label:"分管负责人"}},[r("el-select",{attrs:{placeholder:"请选择分管负责人"},on:{change:e.handLeaderChanged},model:{value:e.form.leader,callback:function(t){e.$set(e.form,"leader",t)},expression:"form.leader"}},e._l(e.leaders,(function(e){return r("el-option",{key:e.personID,attrs:{label:e.name,value:e.personID}})})),1)],1)],1)],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24,offset:0}},[r("el-row",{attrs:{gutter:40}},[r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{"label-width":"90px"}},[r("el-form-item",{attrs:{label:"职务"}},[r("el-input",{model:{value:e.form.post,callback:function(t){e.$set(e.form,"post",t)},expression:"form.post"}})],1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{"label-width":"90px"}},[r("el-form-item",{attrs:{label:"联系电话"}},[r("el-input",{model:{value:e.form.leaderMobile,callback:function(t){e.$set(e.form,"leaderMobile",t)},expression:"form.leaderMobile"}})],1)],1)],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24,offset:0}},[r("el-row",{attrs:{gutter:40}},[r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{"label-width":"90px"}},[r("el-form-item",{attrs:{label:"负责科室"}},[r("el-cascader",{attrs:{placeholder:"负责科室",options:e.data,props:{label:"groupName",value:"groupID",children:"children",checkStrictly:!0,emitPath:!1},filterable:""},on:{change:e.handDeptChange},model:{value:e.form.personGroupID,callback:function(t){e.$set(e.form,"personGroupID",t)},expression:"form.personGroupID"}})],1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{"label-width":"90px"}},[r("el-form-item",{attrs:{label:"科室负责人"}},[r("el-select",{attrs:{placeholder:"请选择科室负责人"},on:{change:e.handPersonChanged},model:{value:e.form.person,callback:function(t){e.$set(e.form,"person",t)},expression:"form.person"}},e._l(e.persons,(function(e){return r("el-option",{key:e.personID,attrs:{label:e.name,value:e.personID}})})),1)],1)],1)],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24,offset:0}},[r("el-row",{attrs:{gutter:40}},[r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{"label-width":"90px"}},[r("el-form-item",{attrs:{label:"联系电话"}},[r("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.form.personMobile,callback:function(t){e.$set(e.form,"personMobile",t)},expression:"form.personMobile"}})],1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{"label-width":"90px"}},[r("el-form-item",{attrs:{label:"排序号"}},[r("el-input",{model:{value:e.form.index,callback:function(t){e.$set(e.form,"index",t)},expression:"form.index"}})],1)],1)],1)],1)],1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveCommandSystem}},[e._v("确 定")])],1)],2),r("div",{staticClass:"search"},[r("el-row",[r("el-col",{attrs:{span:24,offset:0}},[r("el-row",{attrs:{gutter:40}},[r("el-col",{attrs:{span:6}},[r("el-form",{attrs:{"label-width":"40px"}},[r("el-form-item",{attrs:{label:"姓名"}},[r("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.queryPars.personName,callback:function(t){e.$set(e.queryPars,"personName",t)},expression:"queryPars.personName"}})],1)],1)],1),r("el-col",{attrs:{span:6}},[r("el-form",{attrs:{"label-width":"70px"}},[r("el-form-item",{attrs:{label:"联系号码"}},[r("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.queryPars.telephone,callback:function(t){e.$set(e.queryPars,"telephone",t)},expression:"queryPars.telephone"}})],1)],1)],1),r("el-col",{attrs:{span:6}},[r("el-form",{attrs:{"label-width":"80px"}},[r("el-form-item",{attrs:{label:"部门名称"}},[r("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.queryPars.groupName,callback:function(t){e.$set(e.queryPars,"groupName",t)},expression:"queryPars.groupName"}})],1)],1)],1),r("el-col",{attrs:{span:6}},[r("el-button",{attrs:{type:"primary"},on:{click:e.getSearch}},[e._v("搜索")]),r("el-button",{attrs:{type:"warning"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增成员单位")])],1)],1)],1)],1)],1),r("div",{staticClass:"content"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[r("el-table-column",{attrs:{prop:"kindName",label:"所属专项",fixed:"",width:"120"}}),r("el-table-column",{attrs:{prop:"leaderGroupName",label:"单位名称",fixed:"",width:"120"}}),r("el-table-column",{attrs:{prop:"officeTel",label:"值班电话",fixed:"",width:"100"}}),r("el-table-column",{attrs:{prop:"leaderName",fixed:"",label:"分管负责人",width:"100"}}),r("el-table-column",{attrs:{prop:"leaderPost",label:"职务",width:"150"}}),r("el-table-column",{attrs:{prop:"leaderMobile",label:"联系电话",width:"100"}}),r("el-table-column",{attrs:{prop:"groupName",label:"负责科室",width:"120"}}),r("el-table-column",{attrs:{prop:"personName",label:"科室负责人",width:"80"}}),r("el-table-column",{attrs:{prop:"personMobile",label:"联系电话",width:"100"}}),r("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(r){return e.handEdit(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){return e.handDelete(t.row)}}},[e._v("删除")])]}}])})],1),r("div",{staticClass:"page"},[r("el-pagination",{staticStyle:{"margin-top":"5px"},attrs:{background:"",layout:"total,prev, pager, next",total:e.total,"current-page":e.queryPars.pageIndex,"page-size":e.queryPars.pageSize},on:{"current-change":e.handPageIndexChanged}})],1)],1),r("div",{staticClass:"right"},[r("el-input",{attrs:{placeholder:"输入关键字进行过滤"}}),r("el-tree",{ref:"tree",attrs:{data:e.treeProjects,id:"el-tree",props:e.defaultProps,"show-checkbox":!0},on:{"check-change":e.getCheckedNodes}})],1)],1)},a=[],l=(r("4de4"),r("baa5"),r("d81d"),r("13d5"),r("ade3")),n=(r("96cf"),r("1da1")),s=r("7c15"),i={watch:{filterText:function(e){this.$refs.tree.filter(e)}},mounted:function(){this.getSearch()},created:function(){var e=this;this.getGroups(this.treePars).then((function(t){e.data=t})),this.loadProjects()},methods:{getSearch:function(){var e=this;console.log(this.queryPars),Object(s["f"])(this.queryPars).then((function(t){e.tableData=t.data,console.log(t),e.total=t.total}))},loadProjects:function(){var e=this,t={codeType:12,pageSize:100};Object(s["c"])(t).then((function(t){var r=t.data;e.projects=r;var o=r.reduce((function(e,t){return e[t.codeID]=t,t.children=[],e}),{}),a=r.filter((function(e){return o[e.parentID]&&o[e.parentID].children.push(e),"-1"==e.parentID}));e.treeProjects=a}))},handLeaderChanged:function(e){var t=this;console.log(e),this.leaders.map((function(r,o){if(r.personID==e)return t.form.leaderPersonID=e,t.form.post=r.post,void(t.form.leaderMobile=r.mobile)}))},getCheckedNodes:function(){var e=this;this.queryPars.kindID=void 0;this.$refs.tree.getCheckedNodes().map((function(t,r){return console.log("tree"),void 0!=t&&(e.queryPars.kindID=t.codeID,console.log(e.queryPars.kindID)),void 0===t}));console.log(this.queryPars.kindID),this.getSearch()},handPageIndexChanged:function(e){this.queryPars.pageIndex=e,this.getSearch()},handEdit:function(e){this.dialogFormVisible=!0,this.form.leaderGroupID=e.leaderGroupID,this.handChange(this.form.leaderGroupID),this.form.leaderPersonID=e.leaderID,this.form.leader=e.leaderID,this.handLeaderChanged(e.leaderID),this.form.personGroupID=e.groupID,this.handDeptChange(this.form.personGroupID),this.form.person=e.personID,this.form.personMobile=e.mobile,this.form.kindID=e.kindID,this.form.commandID=e.commandID},handDelete:function(e){var t=this;this.form.commandID=e.commandID,this.$confirm("删除后将不能恢复,是否继续?","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((function(){var e=[t.form.commandID],r={ids:e};Object(s["n"])(r).then((function(e){console.log(e),1==e.status?(t.$message({message:"人员删除成功!",type:"success"}),t.getSearch()):t.$message({message:"人员删除失败!",type:"error"})}))}))},handPersonChanged:function(e){var t=this;console.log("handPersonChanged"),console.log(this.persons),console.log(e),this.persons.map((function(r,o){if(r.personID==e)return t.form.personID=e,t.form.personMobile=r.mobile,void console.log("find")}))},handChange:function(e){var t=this,r=[];r.push(e);var o={groupID:r};Object(s["hb"])(o).then((function(e){console.log(o,e),t.form.officeTel="",t.leaders=[],e.data.map((function(e,r){return 1==e.duty?t.form.officeTel+=e.mobile+",":t.leaders.push(e),void 0===e})),t.form.officeTel=t.form.officeTel.substring(0,t.form.officeTel.lastIndexOf(","))}))},handDeptChange:function(e){var t=this,r=[];r.push(e);var o={groupID:r};Object(s["hb"])(o).then((function(e){t.persons=[],e.data.map((function(e,r){return 0==e.duty&&t.persons.push(e),void 0===e}))}))},getGroups:function(e){return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=[],t.next=3,Object(s["Wb"])(e).then((function(e){console.log(e.data);var t=[];t=e.data;var o=t.reduce((function(e,t){return e[t.groupID]=t,t.children=[],e}),{});r=t.filter((function(e){return o[e.parentID]&&o[e.parentID].children.push(e),"-1"==e.parentID}))}));case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))()},saveCommandSystem:function(){var e=this;console.log(this.form);var t=Object(l["a"])({commandID:this.form.commandID,typeID:2,leaderPersonID:this.form.leaderPersonID,leaderGroupID:this.form.leaderGroupID,groupID:this.form.personGroupID,personID:this.form.personID,index:this.form.index,kindID:this.form.kindID},"commandID",this.form.commandID);Object(s["d"])(t).then((function(t){console.log(t),1==t.status?(e.$message({message:"保存指挥体系成员单位成功!",type:"success"}),e.dialogFormVisible=!1,e.getSearch()):e.$message({message:"保存指挥体系成员单位失败!",type:"error"})}))}},data:function(){return{dialogFormVisible:!1,projects:[],treeProjects:[],nodeData:{},leaders:[],leader:"",persons:[],person:"",data:[],total:0,pars:{codeID:78,groupName:void 0,parentID:void 0,groupID:void 0,pageIndex:void 0,pageSize:1e3},queryPars:{typeID:2,pageSize:10,pageIndex:1,kindID:void 0,personName:void 0,groupName:void 0,telephone:void 0},treePars:{codeID:78,groupName:void 0,parentID:void 0,groupID:void 0,pageIndex:void 0,pageSize:1e3},formLabelWidth:"80px",form:{commandID:"",officeTel:"",post:"",leaderMobile:"",personMobile:"",leaderGroupID:"",kindID:"",personGroupID:"",leaderPersonID:"",personID:"",index:0,typeID:1},defaultProps:{children:"children",label:"codeName"},tableData:[],treeData:[{label:"应急指挥信息系统",id:1,children:[{label:"县委",id:2,children:[{id:3,label:"办公室"}]}]}]}}},c=i,d=(r("f6e4"),r("2877")),p=Object(d["a"])(c,o,a,!1,null,"cbcb25d8",null);t["default"]=p.exports},d58f:function(e,t,r){var o=r("1c0b"),a=r("7b0b"),l=r("44ad"),n=r("50c4"),s=function(e){return function(t,r,s,i){o(r);var c=a(t),d=l(c),p=n(c.length),f=e?p-1:0,u=e?-1:1;if(s<2)while(1){if(f in d){i=d[f],f+=u;break}if(f+=u,e?f<0:p<=f)throw TypeError("Reduce of empty array with no initial value")}for(;e?f>=0:p>f;f+=u)f in d&&(i=r(i,d[f],f,c));return i}};e.exports={left:s(!1),right:s(!0)}},e58c:function(e,t,r){"use strict";var o=r("fc6a"),a=r("a691"),l=r("50c4"),n=r("a640"),s=r("ae40"),i=Math.min,c=[].lastIndexOf,d=!!c&&1/[1].lastIndexOf(1,-0)<0,p=n("lastIndexOf"),f=s("indexOf",{ACCESSORS:!0,1:0}),u=d||!p||!f;e.exports=u?function(e){if(d)return c.apply(this,arguments)||0;var t=o(this),r=l(t.length),n=r-1;for(arguments.length>1&&(n=i(n,a(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}:c},f6e4:function(e,t,r){"use strict";r("8b08")}}]);