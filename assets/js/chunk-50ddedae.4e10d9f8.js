(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50ddedae"],{"13d5":function(e,t,a){"use strict";var r=a("23e7"),l=a("d58f").left,i=a("a640"),o=a("ae40"),n=a("2d00"),s=a("605d"),d=i("reduce"),c=o("reduce",{1:0}),m=!s&&n>79&&n<83;r({target:"Array",proto:!0,forced:!d||!c||m},{reduce:function(e){return l(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"8add":function(e,t,a){},b205:function(e,t,a){"use strict";a("8add")},b640:function(e,t,a){},b85c:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0");var r=a("06c5");function l(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=Object(r["a"])(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var l=0,i=function(){};return{s:i,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return n=e.done,e},e:function(e){s=!0,o=e},f:function(){try{n||null==a["return"]||a["return"]()}finally{if(s)throw o}}}}},caac:function(e,t,a){"use strict";a("b640")},d58f:function(e,t,a){var r=a("1c0b"),l=a("7b0b"),i=a("44ad"),o=a("50c4"),n=function(e){return function(t,a,n,s){r(a);var d=l(t),c=i(d),m=o(d.length),u=e?m-1:0,h=e?-1:1;if(n<2)while(1){if(u in c){s=c[u],u+=h;break}if(u+=h,e?u<0:m<=u)throw TypeError("Reduce of empty array with no initial value")}for(;e?u>=0:m>u;u+=h)u in c&&(s=a(s,c[u],u,d));return s}};e.exports={left:n(!1),right:n(!0)}},d87d:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("template",{slot:"title"},[a("div",{staticStyle:{"font-size":"14px",color:"blue","font-weight":"bold"}},[e._v("保存应急物资")])]),a("el-tabs",{staticStyle:{margin:"0",padding:"0"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"first"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-date"}),e._v(" 仓库信息")]),a("el-form",{attrs:{model:e.form}},[a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"仓库类型"}},[a("el-select",{attrs:{placeholder:"请选择仓库类型"},model:{value:e.form.kind,callback:function(t){e.$set(e.form,"kind",t)},expression:"form.kind"}},e._l(e.depositoryTypes,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"仓库名称"}},[a("el-input",{attrs:{placeholder:"请输入仓库名称"},model:{value:e.form.depositoryName,callback:function(t){e.$set(e.form,"depositoryName",t)},expression:"form.depositoryName"}})],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"归属区域"}},[a("el-cascader",{attrs:{placeholder:"归属区域",options:e.types,props:{label:"codeName",value:"codeID",children:"children",checkStrictly:!0,emitPath:!1},filterable:""},model:{value:e.form.area,callback:function(t){e.$set(e.form,"area",t)},expression:"form.area"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"存储地址"}},[a("el-input",{attrs:{placeholder:"请输入存储地址"},model:{value:e.form.addr,callback:function(t){e.$set(e.form,"addr",t)},expression:"form.addr"}})],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"归属单位"}},[a("el-input",{attrs:{placeholder:"请输入归属单位"},model:{value:e.form.units,callback:function(t){e.$set(e.form,"units",t)},expression:"form.units"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"办公电话"}},[a("el-input",{attrs:{placeholder:"办公电话"},model:{value:e.form.officeTel,callback:function(t){e.$set(e.form,"officeTel",t)},expression:"form.officeTel"}})],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"管理员"}},[a("el-input",{attrs:{placeholder:"请输入管理员"},model:{value:e.form.contact,callback:function(t){e.$set(e.form,"contact",t)},expression:"form.contact"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{attrs:{placeholder:"请输入联系电话"},model:{value:e.form.tel,callback:function(t){e.$set(e.form,"tel",t)},expression:"form.tel"}})],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"运输方式"}},[a("el-input",{attrs:{placeholder:"请输入运输方式"},model:{value:e.form.shipping,callback:function(t){e.$set(e.form,"shipping",t)},expression:"form.shipping"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"所属图层"}},[a("el-cascader",{attrs:{placeholder:"所属图层",options:e.layers,props:{label:"name",value:"id",children:"children",checkStrictly:!0,emitPath:!1},filterable:""},model:{value:e.form.layerID,callback:function(t){e.$set(e.form,"layerID",t)},expression:"form.layerID"}})],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"地理经度"}},[a("el-input",{attrs:{placeholder:"请输入地理纬度"},model:{value:e.form.longitude,callback:function(t){e.$set(e.form,"longitude",t)},expression:"form.longitude"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"地理纬度"}},[a("el-input",{attrs:{placeholder:"请输入地理纬度"},model:{value:e.form.latitude,callback:function(t){e.$set(e.form,"latitude",t)},expression:"form.latitude"}})],1)],1)],1)],1)],1)],1)],1)],1),a("el-tab-pane",{attrs:{name:"second"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-date"}),e._v(" 地图标绘")]),a("my-map",{attrs:{gisInfo:e.gis},on:{marked:e.handMarked}})],1),a("el-tab-pane",{attrs:{name:"third"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-date"}),e._v(" 仓库物资")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.materialListData}},[a("el-table-column",{attrs:{prop:"name",label:"名称",fixed:"",width:"120"}}),a("el-table-column",{attrs:{prop:"materialTypeName",label:"物资类型",fixed:"",width:"120"}}),a("el-table-column",{attrs:{prop:"model",label:"规格型号",width:"120"}}),a("el-table-column",{attrs:{prop:"num",label:"数量",width:"100"}}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){return e.handEditMaterial(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handDeleteMaterial(t.row)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{background:"",layout:"total,prev, pager, next",total:e.materialTotal,"current-page":e.searchMaterialPars.pageIndex,"page-size":e.searchMaterialPars.pageSize},on:{"current-change":e.handMaterialPageIndexChanged}}),a("el-form",{attrs:{model:e.form}},[a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"物资类型"}},[a("el-select",{attrs:{placeholder:"请选择物资类型"},model:{value:e.materialForm.materialType,callback:function(t){e.$set(e.materialForm,"materialType",t)},expression:"materialForm.materialType"}},e._l(e.materialKinds,(function(e){return a("el-option",{key:e.codeID,attrs:{label:e.codeName,value:e.codeID}})})),1)],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"物资名称"}},[a("el-input",{attrs:{placeholder:"请输入物资名称"},model:{value:e.materialForm.materialName,callback:function(t){e.$set(e.materialForm,"materialName",t)},expression:"materialForm.materialName"}})],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"规格型号"}},[a("el-input",{attrs:{placeholder:"请输入规格型号"},model:{value:e.materialForm.model,callback:function(t){e.$set(e.materialForm,"model",t)},expression:"materialForm.model"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"物资数量"}},[a("el-input",{attrs:{placeholder:"请输入物资数量"},model:{value:e.materialForm.num,callback:function(t){e.$set(e.materialForm,"num",t)},expression:"materialForm.num"}})],1)],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"物资单位"}},[a("el-input",{attrs:{placeholder:"请输入物资单位"},model:{value:e.materialForm.unit,callback:function(t){e.$set(e.materialForm,"unit",t)},expression:"materialForm.unit"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handSaveMaterial}},[e._v("保存")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handNewMaterail}},[e._v("新增")])],1)],1)],1)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handSave}},[e._v("确 定")])],1)],2),a("div",{staticClass:"search"},[a("el-row",[a("el-col",{attrs:{span:24,offset:0}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:6}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"仓库类型"}},[a("el-select",{attrs:{placeholder:"请选择仓库类型",multiple:""},model:{value:e.searchPars.kind,callback:function(t){e.$set(e.searchPars,"kind",t)},expression:"searchPars.kind"}},e._l(e.depositoryTypes,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-form",{attrs:{"label-width":"70px"}},[a("el-form-item",{attrs:{label:"存储区域"}},[a("el-select",{attrs:{placeholder:"请选择存储区域",multiple:""},model:{value:e.searchPars.area,callback:function(t){e.$set(e.searchPars,"area",t)},expression:"searchPars.area"}},e._l(e.types,(function(e){return a("el-option",{key:e.codeID,attrs:{label:e.codeName,value:e.codeID}})})),1)],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"物资名称"}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.searchPars.materialName,callback:function(t){e.$set(e.searchPars,"materialName",t)},expression:"searchPars.materialName"}})],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handSearch}},[e._v("搜索")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handNew}},[e._v("新增仓库")])],1)],1)],1)],1)],1),a("div",{staticClass:"content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:!0,data:e.tableData}},[a("el-table-column",{attrs:{prop:"kind",label:"仓库类型",width:"80",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.materialKind(t.row))+" ")]}}])}),a("el-table-column",{attrs:{prop:"depositoryName",label:"仓库名称",width:"160",fixed:""}}),a("el-table-column",{attrs:{prop:"areaName",label:"存储区域",width:"140",fixed:""}}),a("el-table-column",{attrs:{prop:"units",label:"归属单位",width:"150",fixed:""}}),a("el-table-column",{attrs:{prop:"officeTel",label:"办公电话",width:"150"}}),a("el-table-column",{attrs:{prop:"contact",label:"管理员",width:"70"}}),a("el-table-column",{attrs:{prop:"tel",label:"联系电话",width:"150"}}),a("el-table-column",{attrs:{prop:"shipping",label:"运输方式",width:"150"}}),a("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){return e.handEdit(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handDel(t.row)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"5px"},attrs:{background:"",layout:"total,prev, pager, next",total:e.total,"current-page":e.searchPars.pageIndex,"page-size":e.searchPars.pageSize},on:{"current-change":e.handPageIndexChanged}})],1)],1)},l=[],i=(a("4de4"),a("d81d"),a("13d5"),a("b0c0"),a("d3b7"),a("ac1f"),a("25f0"),a("1276"),a("600f")),o=a("7c15"),n=a("de9b"),s={watch:{filterText:function(e){this.$refs.tree.filter(e)}},data:function(){return{search_addr:"",activeName:"first",map:void 0,depositoryTypes:[{label:"应急物资",value:1},{label:"应急装备",value:2}],layers:[],kinds:[],materialKinds:[],data:[],types:[],materialListData:[],kindProps:{multiple:!0},treePars:{codeID:82,groupName:void 0,parentID:void 0,groupID:void 0,pageIndex:void 0,pageSize:1e3},gis:{longitude:0,latitude:0,layerID:999},searchPars:{kind:void 0,area:[],materialName:void 0,pageIndex:void 0,pageSize:10},searchMaterialPars:{pageIndex:void 0,depositoryID:void 0,pageSize:5},materialTotal:0,total:0,saveForm:{personID:void 0,groupID:void 0,types:[],groupName:void 0,name:void 0,nameJP:void 0,duty:0,post:void 0,mobile:void 0,tel:void 0,email:void 0,fax:void 0,index:0,comment:void 0},dialogFormVisible:!1,formLabelWidth:"80px",leaders:[],materialForm:{materialID:void 0,depositoryID:void 0,materialType:void 0,name:void 0,model:void 0,unit:void 0,num:0,materialName:void 0},form:{layerID:5,depositoryID:void 0,kind:void 0,depositoryName:void 0,addr:void 0,area:void 0,units:void 0,officeTel:void 0,contact:void 0,tel:void 0,shipping:void 0,longitude:void 0,latitude:void 0,label:void 0},tableData:[],treeData:[]}},components:{"my-map":n["a"]},methods:{handMarked:function(e,t){console.log("handMarked"),console.log(e),console.log(t),this.form.longitude=e,this.form.latitude=t},materialKind:function(e){return 1==e.kind?"储备库":2==e.kind?"装备库":void 0},selectPoint:function(){var e;i["a"].set_map_operation_mode(this.map,2,e).then((function(e){console.log(e)}))},saveGIS:function(){var e={layercode:parseInt(this.form.layerID),latitude:parseFloat(this.form.latitude),longitude:parseFloat(this.form.longitude),featureid:this.form.depositoryID,label:this.form.label,minzoom:0};Object(o["wb"])(e).then((function(t){console.log("gis"),console.log(e),console.log(t),console.log("gis")}))},handPoint:function(){var e=this;i["a"].add_point(this.map,this.form.layerID,999).then((function(t){e.form.longitude=t[0],e.form.latitude=t[1],e.$message({message:"("+t[0]+","+t[1]+")",type:"success"})}))},searchMap:function(){var e=this;if(i["a"].delete_draw(this.map,"search"),i["a"].delete_draw(this.map,"center"),""!=this.search_addr){var t=0,a=0;i["a"].local_search(this.map.getLayers().getArray()[0],this.search_addr,!1).then((function(r){if(r.length>0){var l=r[0].location,o=l.split(","),n=i["a"].gaode_gcs(o);n&&2==n.length&&(t=n[0],a=n[1],console.log(t),console.log(a),i["a"].center_display(parseFloat(t),parseFloat(a),200,e.map))}})),this.handPoint()}},initMap:function(){this.gis.longitude=this.form.longitude,this.gis.latitude=this.form.latitude,this.gis.layerID=this.form.layerID},handleClick:function(e,t){"second"==this.activeName&&this.initMap()},loadKinds:function(){var e=this,t={codeType:50};Object(o["c"])(t).then((function(t){e.kinds=t.data}))},loadMaterialKinds:function(){var e=this,t={codeType:2};Object(o["c"])(t).then((function(t){e.materialKinds=t.data}))},loadTypes:function(){var e=this,t={codeType:84,pageSize:100};Object(o["c"])(t).then((function(t){var a=t.data,r=a.reduce((function(e,t){return e[t.codeID]=t,t.children=[],e}),{}),l=a.filter((function(e){return r[e.parentID]&&r[e.parentID].children.push(e),"-1"==e.parentID}));e.types=l}))},handContacts:function(e){return e.contacts},handOfficeContacts:function(e){var t=[];return e.officeTel.map((function(e,a){t.push({mobile:e})})),t},handAllContent:function(e,t){var a="";switch(t){case 1:a=e.teamType;var r="";return a.map((function(e,t){r+=e.codeName+","})),r;case 2:return a=e.teamName,a;case 3:return a=e.equipments,a}},handSubConent:function(e,t){var a="";switch(t){case 1:a=e.teamType;var r="";return a.map((function(e,t){r+=e.codeName+","})),r.length>10&&(r=r.substring(0,10)+"..."),r;case 2:return a=e.teamName,a.length>10&&(a=a.substring(0,10)+"..."),a;case 3:return a=e.equipments,null==a?"":(a.length>10&&(a=a.substring(0,10)+"..."),a);case 4:var l=e.contacts;return 0==l.length?"":l.length>1?l[0].name+"("+l[0].mobile+")...":l[0].name+"("+l[0].mobile+")";case 5:var i="";return e.officeTel.map((function(e,t){i+=e+","})),i}},handChange:function(e){var t=this,a=[];a.push(e);var r={groupID:a};Object(o["hb"])(r).then((function(e){t.leaders=[],e.data.map((function(e,a){return 0==e.duty&&t.leaders.push(e),void 0===e}))}))},handSearch:function(){var e=this;console.log(this.searchPars),Object(o["r"])(this.searchPars).then((function(t){e.tableData=t.data,e.total=t.total}))},handSearchMaterial:function(){var e=this;this.searchMaterialPars.depositoryID=this.form.depositoryID,Object(o["nb"])(this.searchMaterialPars).then((function(t){console.log(e.searchMaterialPars),console.log(t),e.materialListData=t.data,e.materialTotal=t.total}))},handPageIndexChanged:function(e){this.searchPars.pageIndex=e,this.handSearch()},handMaterialPageIndexChanged:function(e){this.searchMaterialPars.pageIndex=e,this.handSearchMaterial()},handLeaderChanged:function(e){var t=this;this.leaders.map((function(a,r){if(a.personID==e)return t.form.personID=e,t.form.mobile=a.mobile,void(t.form.post=a.post)}))},handSave:function(){this.handSaveTeam()},handNewMaterail:function(){this.materialForm.materialID=void 0,this.materialForm.materialType=void 0,this.materialForm.num=0,this.materialForm.unit=void 0,this.materialForm.name=void 0,this.materialForm.materialName=void 0,this.materialForm.model=void 0},handEditMaterial:function(e){this.handNewMaterail(),this.materialForm.materialID=e.materialID,this.materialForm.materialType=e.materialType,this.materialForm.num=e.num,this.materialForm.unit=e.unit,this.materialForm.materialName=e.name,this.materialForm.model=e.model,this.materialForm},handSaveMaterial:function(){var e=this;this.materialForm.num=parseFloat(this.materialForm.num),this.materialForm.name=this.materialForm.materialName,this.materialForm.depositoryID=this.form.depositoryID,console.log("handSaveMaterial"),console.log(this.materialForm),Object(o["lb"])(this.materialForm).then((function(t){1==t.status&&(e.materialForm.materialID=t.data,e.$message({message:"保存仓库物资成功!",type:"success"}),e.handSearchMaterial())}))},handDeleteMaterial:function(e){var t=this;this.$confirm("删除后将不能恢复,是否继续?","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[e.materialID],r={ids:a};Object(o["mb"])(r).then((function(e){1==e.status?(t.$message({message:"删除应急物资成功!",type:"success"}),t.handSearchMaterial()):t.$message({message:"删除应急物资失败!",type:"error"})}))}))},handNew:function(){this.form.layerID=-1,this.form.depositoryID=void 0,this.form.shipping=void 0,this.form.longitude=0,this.form.latitude=0,this.form.kind=void 0,this.form.depositoryName=void 0,this.form.addr=void 0,this.form.area=void 0,this.form.units=void 0,this.form.officeTel=void 0,this.form.contact=void 0,this.form.tel=void 0,this.dialogFormVisible=!0},handEdit:function(e){this.handNew(),this.form.layerID=parseInt(e.layerID),this.form.depositoryID=e.depositoryID,this.materialForm.depositoryID=e.depositoryID,this.form.shipping=e.shipping,this.form.longitude=parseFloat(e.longitude),this.form.latitude=parseFloat(e.latitude),this.form.kind=e.kind,this.form.depositoryName=e.depositoryName,this.form.addr=e.addr,this.form.area=e.area,this.form.units=e.units,this.form.officeTel=e.officeTel,this.form.contact=e.contact,this.form.tel=e.tel,this.form.label=e.depositoryName,this.handSearchMaterial()},handDel:function(e){var t=this;this.$confirm("删除后将不能恢复,是否继续?","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((function(){var a=[e.depositoryID],r={ids:a};Object(o["q"])(r).then((function(e){1==e.status?(t.$message({message:"物资仓库删除成功!",type:"success"}),t.handSearch()):t.$message({message:"物资仓库删除失败!",type:"error"})}))}))},handSaveTeam:function(){var e=this;this.form.longitude=parseFloat(this.form.longitude),this.form.latitude=parseFloat(this.form.latitude),this.form.layerID=this.form.layerID.toString(),this.form.kind=parseInt(this.form.kind),Object(o["p"])(this.form).then((function(t){1==t.status?(e.form.teamID=t.data,e.$message({message:"保存物资仓库成功!",type:"success"}),e.handSearch(),e.saveGIS(),e.dialogFormVisible=!1):e.$message({message:"保存物资仓库失败!",type:"error"})}))},getGroups:function(){var e=this;Object(o["Wb"])(this.treePars).then((function(t){var a=t.data,r=a.reduce((function(e,t){return e[t.groupID]=t,t.children=[],e}),{}),l=a.filter((function(e){return r[e.parentID]&&r[e.parentID].children.push(e),"-1"==e.parentID}));e.data=l}))},handGetMapLayer:function(){var e=this,t={type:"point"};Object(o["ac"])(t).then((function(t){var a=t.data,r=a.reduce((function(e,t){return e[t.id]=t,t.children=[],e}),{}),l=a.filter((function(e){return r[e.fid]&&r[e.fid].children.push(e),0==e.fid}));e.layers=l,console.log(l)}))}},created:function(){this.loadKinds(),this.loadMaterialKinds(),this.loadTypes(),this.handSearch(),this.handGetMapLayer()},mounted:function(){this.getGroups()}},d=s,c=(a("caac"),a("2877")),m=Object(c["a"])(d,r,l,!1,null,"8e310bd4",null);t["default"]=m.exports},de9b:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"50vh"}},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("div",{attrs:{id:"all"}},[a("div",{staticClass:"searchMap"},[a("el-autocomplete",{staticClass:"input-with",staticStyle:{width:"300px"},attrs:{id:"search-input",placeholder:"请输入地址",size:"mini","fetch-suggestions":e.querySearchAsync},on:{change:e.loadSearchResult,select:e.handleAddrSelect},model:{value:e.search_addr,callback:function(t){e.search_addr=t},expression:"search_addr"}}),a("el-button",{staticStyle:{border:"1px"},on:{click:e.handPoint}},[e._v("标记")])],1),a("div",{ref:"map",staticClass:"map",attrs:{id:"commonMap"}})])])],1)},l=[],i=(a("c975"),a("d81d"),a("b0c0"),a("ac1f"),a("1276"),a("b85c")),o=a("600f"),n={data:function(){return{search_addr:"",longitude:0,latitude:0,layerID:999,map:void 0,label:"",resultArr:[],resultList:[]}},props:["gisInfo"],watch:{gisInfo:{immediate:!0,deep:!0,handler:function(e){console.log("----------------------"),console.log(e),this.longitude=e.longitude,this.latitude=e.latitude,this.layerID=e.layerID,this.handInitMap(),this.$forceUpdate()}},search_addr:{deep:!0,handler:function(e,t){this.resultArr=[];for(var a=this.resultList.length,r=[],l=0;l<a;l++)this.resultList[l].value.indexOf(this.search_addr)>=0&&r.push({value:this.resultList[l].value,id:this.resultList[l].id,longitude:this.resultList[l].longitude,latitude:this.resultList[l].latitude});this.resultArr=r}}},methods:{handPoint:function(){var e=this;o["a"].add_point(this.map,999,999,null,"").then((function(t){e.$emit("marked",t[0],t[1])}))},searchMap:function(){var e=this;if(o["a"].delete_draw(this.map,"search"),o["a"].delete_draw(this.map,"center"),""!=this.search_addr){var t=0,a=0;o["a"].local_search(this.map.getLayers().getArray()[0],this.search_addr,!1).then((function(r){if(r.length>0){var l=r[0].location,i=l.split(","),n=o["a"].gaode_gcs(i);n&&2==n.length&&(t=n[0],a=n[1],o["a"].center_display(parseFloat(t),parseFloat(a),200,e.map))}}))}},loadSearchResult:function(){var e=this;this.resultList=[],this.resultArr=[],o["a"].local_search(this.map.getLayers().getArray()[0],this.search_addr,!1).then((function(t){if(t.length>0)for(var a=0;a<t.length;a++){var r=t[a].location,l=r.split(","),n=o["a"].gaode_gcs(l),s=0,d=0;n&&2==n.length&&(s=n[0],d=n[1]),e.resultList.push({value:t[a].name+"("+t[a].address+")",id:t[a].id,longitude:s,latitude:d})}var c,m=Object(i["a"])(e.resultList);try{for(m.s();!(c=m.n()).done;){var u=c.value;e.resultArr.push({value:u.value,id:u.id,longitude:u.longitude,latitude:u.latitude})}}catch(h){m.e(h)}finally{m.f()}}))},querySearchAsync:function(e,t){var a=this.resultArr;t(a)},handleAddrSelect:function(e){o["a"].center_display(parseFloat(e.longitude),parseFloat(e.latitude),200,this.map)},handInitMap:function(){var e=this;setTimeout((function(){void 0!=e.$refs.map&&(void 0==e.map?(console.log("created"),e.map=o["a"].set_map("commonMap",!1,!1,!1,!1,!1),o["a"].add_baselayers(e.map),o["a"].set_layers(e.map).then((function(t){o["a"].add_one_layer_featurelist(e.map,parseInt(e.layerID),[]),o["a"].open_levels(!1,e.map),e.longitude>0?o["a"].center_display(e.longitude,e.latitude,50,e.map):o["a"].center_display(113.07329268615261,28.255592768842703,500,e.map)}))):(console.log("created1"),o["a"].delete_layer_features(e.map,[]),o["a"].cancel_draw(e.map,"get_extent"),o["a"].cancel_draw(e.map,"add_feature"),o["a"].delete_draw(e.map,"range"),o["a"].delete_draw(e.map,"center"),o["a"].set_layers(e.map).then((function(t){o["a"].add_one_layer_featurelist(e.map,parseInt(e.layerID),[]),o["a"].open_levels(!1,e.map),e.longitude>0?(o["a"].center_display(e.longitude,e.latitude,500,e.map),o["a"].delete_draw(e.map,"center")):o["a"].center_display(113.07329268615261,28.255592768842703,500,e.map)}))))}),500)}},mounted:function(){}},s=n,d=(a("b205"),a("2877")),c=Object(d["a"])(s,r,l,!1,null,"6cd33be4",null);t["a"]=c.exports}}]);